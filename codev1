# ---------------- Insert One-Shot Trigger Code Here ----------------
trialClock = core.Clock()  # Create a new clock for trigger timing

# Start the sound once at the beginning of the trial
test_sound.play()

# Prepare trigger delays (in ms from Excel) and trigger codes
trigger_delays_ms = [
    float(trigger_item),
    float(trigger_senonset),
    float(trigger_verbsonset),
    float(trigger_1_F0),
    float(trigger_suffix),
    float(trigger_2_F0)
]

trigger_codes = [
    int(ID_item),
    int(ID_senonset),
    int(ID_verbonset),
    int(ID_1_F0),
    int(ID_suffix),
    int(ID_2_F0)
]

# Send each trigger once, converting ms to seconds and waiting until that moment
for delay_ms, code in zip(trigger_delays_ms, trigger_codes):
    delay_sec = delay_ms / 1000.0  # convert ms to seconds
    wait_time = delay_sec - trialClock.getTime()
    if wait_time > 0:
        core.wait(wait_time)
    send_trigger(code)
    actual_time_ms = trialClock.getTime() * 1000  # log current time in ms
    print(f"Trigger {code} sent at {actual_time_ms:.1f} ms (expected {delay_ms:.1f} ms)")
# ---------------- End One-Shot Trigger Code ----------------
