# Add a column for sentence ID and condition letter
practice_df['sentence_id'] = practice_df['sounds'].str.extract(r'(p\d)')[0]
practice_df['condition'] = practice_df['sounds'].str.extract(r'p\d([a-d])')[0]

# Ensure 4 unique sentence_ids and one of each condition
from random import sample

# Group by sentence_id and pick one version
grouped = practice_df.groupby('sentence_id')
one_per_sentence = grouped.apply(lambda g: g.sample(1)).reset_index(drop=True)

# Randomly choose 1 of each condition (a, b, c, d)
balanced = (
    one_per_sentence.groupby('condition', group_keys=False)
    .apply(lambda g: g.sample(1))
)

practice_selected_rows = balanced.to_dict(orient='records')
