import pandas as pd

# Load the full list of practice trials
df = pd.read_excel('conditions_stress_practice.xlsx')

# Add helper columns if needed
if 'file_name' not in df.columns:
    df['file_name'] = df['sounds'].apply(lambda x: x.split("/")[-1])

# Extract sentence ID and condition from file names like "p1a_saltar.wav"
df['sentence'] = df['file_name'].apply(lambda x: x[:2])   # e.g., 'p1', 'p2'
df['cond'] = df['file_name'].apply(lambda x: x[2])        # e.g., 'a', 'b', 'c', 'd'

# Define fixed target trials
target_combos = ['p1a', 'p2b', 'p3c', 'p4d']
df['combo'] = df['sentence'] + df['cond']

# Select only those rows
selected_practice = df[df['combo'].isin(target_combos)].reset_index(drop=True)

# Final check
if selected_practice.shape[0] != 4:
    raise ValueError("One or more of p1a, p2b, p3c, p4d was not found in conditions_stress_practice.xlsx.")

# Save for PsychoPy loop
selected_practice.to_csv('selected_practice.csv', index=False)
