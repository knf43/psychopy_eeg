import pandas as pd

# Load the full practice set
df = pd.read_excel('conditions_stress_practice.xlsx')

# Add columns if needed
if 'item_id' not in df.columns:
    df['file_name'] = df['sounds'].apply(lambda x: x.split("/")[-1])
    df['item_id'] = df['file_name'].apply(lambda x: x[:2])
    df['cond'] = df['file_name'].apply(lambda x: x[2])

# Fixed items to use
target_combos = ['01a', '02b', '03c', '04d']
df['combo'] = df['item_id'] + df['cond']

# Select those items
selected_practice = df[df['combo'].isin(target_combos)].reset_index(drop=True)

# Safety check
if selected_practice.empty or selected_practice.shape[0] < 4:
    raise ValueError("selected_practice.csv not created correctly â€” check for missing items like 01a, 02b, etc.")

# Save for PsychoPy to read
selected_practice.to_csv('selected_practice.csv', index=False)
