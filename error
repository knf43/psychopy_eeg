# Cast all ID_* columns to string to prevent PsychoPy write() crash
id_cols = [col for col in selected_practice.columns if col.startswith("ID_")]
for col in id_cols:
    selected_practice[col] = selected_practice[col].astype(str).fillna("")



# Cast all ID_* columns to string to prevent PsychoPy write() crash
id_cols = [col for col in final.columns if col.startswith("ID_")]
for col in id_cols:
    final[col] = final[col].astype(str).fillna("")
